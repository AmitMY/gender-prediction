# Gender Prediction from Dutch

## Adding a model
After writing some model, please create the following class:

```python
from data.reader import Data

class ModelRunner:
    def __init__(self, model, train, dev, opt={}):
        self.train_set = train
        self.dev_set = dev
        self.opt = opt
        
        # Initialize your model
        # If you have some options for your model, you will get them in opt.
        

    def load(self, path):
        # If possible, load your model from a file
        pass

    def save(self, path):
        # If possible, save your model to a file
        pass
    
    def train(self):
        # Here you should have the main training loop.
        while True:
            # Train an epoch, or something
            result = self.eval(self.dev_set) # A number between 0 and 100
            yield result
        
        # If your model does not include a training loop, and just returns a result:
        result = self.eval(self.dev_set)
        return [result]

# To test if your model runs at all
if __name__ == '__main__':
    train, dev = Data("All", "train", tokenize=False).split() # Tokenize=False is just faster, but less accurate

    inst = ModelRunner(model="some name or parameter", train=train, dev=dev, opt={})
    first_epoch = next(iter(inst.train())) # Returns first result
    inst.save("checkpoint") # Make sure this doesn't error
    inst.load("checkpoint") # Make sure this doesn't error
```

Once it is implemented, 

### Experiments
- Model.X means a new seed for the model
- Model+ means it includes frozen fasttext embeddings


#UNIGRAMS

|TRAIN|DEV|SVM|LOG|RF|
| --- | - | - | - | -|
|Twitter 90%|Twitter 10%|58%|58%|60%|
|YouTube 90%|YouTube 10%|57%|59%|58%|
|News 90%|News 10%|59%|57%|56%|
| -------| ------ | - | - | - |
|Twitter, News|YouTube|53%|53%|51%|
|YouTube, News|News|53%|53%|52%|
|Twitter, Youtube|Twitter|52%|54%|51%|


#POS

|TRAIN|DEV|SVM|LOG|RF|
| --- | - | - | - | -|
|Twitter 90%|Twitter 10%|44%|43%|45%|
|YouTube 90%|YouTube 10%|58%|58%|55%|
|News 90%|News 10%|18%|18%|16%|
| -------| ------ | - | - | - |
|Twitter, News|YouTube|50%|R|R|
|YouTube, News|Twitter|51%|R|R|
|Twitter, Youtube|News|50%|R|R|

#UNIGRAMS + POS

|TRAIN |DEV|SVM|LOG|RF|
| ---- | - | - | - | -|
|Twitter 90%|Twitter 10%|59%|58%|51%|
|YouTube 90%|YouTube 10%|56%|61%|56%|
|News 90%|News 10%|59%|58%|53%|
| -------| ------ | - | - | - |
|Twitter, News|YouTube|52%|52%|RUN|
|YouTube, News|Twitter|52%|52%|RUN|
|Twitter, Youtube|News|RUN|52%|RUN|




| Model | Twitter 90% Twitter 10% | YouTube 90% YouTube 10% | YouTube, News Twitter | Twitter, News YouTube | Twitter, YouTube News | News 90% News 10% | Twitter 90%, Twisty Twitter 10% | YouTube, News, CSI Twitter |
| ----- | ----------------------- | ----------------------- | --------------------- | --------------------- | --------------------- | ----------------- | ------------------------------- | -------------------------- |
| CNN.n+.0 | 62.46 | 59.70 | 53.55 | 52.91 | 51.79 | 59.50 | ? | ? |
| CNN.n+.1 | 63.51 | 60.23 | 55.20 | 53.21 | 52.52 | 60.00 | ? | ? |
| CNN.n+.2 | 63.73 | ? | ? | ? | 52.62 | 59.50 | ? | ? |
| CNN.n.0 | 60.57 | 58.87 | 53.72 | 52.78 | 50.74 | 54.67 | ? | __**53.08**__ |
| CNN.n.1 | 60.57 | 58.72 | 50.99 | 55.19 | 52.84 | 54.17 | ? | ? |
| CNN.n.2 | 59.16 | ? | ? | ? | 52.47 | ? | ? | ? |
| CNN.y+.0 | 63.79 | 59.45 | 54.04 | 53.69 | 52.03 | 61.17 | ? | ? |
| CNN.y+.1 | 63.63 | 59.91 | 53.89 | 53.06 | 52.26 | 61.17 | ? | ? |
| CNN.y+.2 | 63.38 | ? | ? | 53.29 | 52.17 | ? | ? | ? |
| CNN.y.0 | 59.02 | 57.43 | 51.36 | 53.82 | 51.90 | 56.83 | ? | ? |
| CNN.y.1 | 60.32 | 58.19 | 52.93 | __**56.73**__ | 51.64 | 57.50 | ? | ? |
| CNN.y.2 | 60.21 | ? | ? | ? | 51.67 | ? | ? | ? |
| KENLM.n.3.0 | 62.34 | 58.49 | 53.11 | 49.40 | 52.21 | 61.96 | ? | ? |
| KENLM.n.3.1 | 62.34 | 58.49 | 53.11 | 49.40 | 52.21 | 61.96 | ? | ? |
| KENLM.n.3.2 | 62.34 | ? | ? | ? | 52.21 | 61.96 | ? | ? |
| KENLM.n.4.0 | 62.42 | 57.69 | 53.27 | 49.36 | 52.21 | 61.41 | ? | ? |
| KENLM.n.4.1 | 62.42 | 57.69 | 53.27 | 49.36 | 52.21 | 61.41 | ? | ? |
| KENLM.n.4.2 | 62.42 | ? | ? | ? | 52.21 | ? | ? | ? |
| KENLM.n.5.0 | 62.42 | 57.50 | 53.32 | 49.38 | 52.13 | 60.60 | ? | ? |
| KENLM.n.5.1 | 62.42 | 57.50 | 53.32 | 49.38 | 52.13 | 60.60 | ? | ? |
| KENLM.n.5.2 | 62.42 | ? | 53.32 | 49.38 | 52.13 | ? | ? | ? |
| KENLM.n.6.0 | 62.42 | 57.61 | 53.32 | 49.38 | 52.13 | 60.87 | 78.51 | ? |
| KENLM.n.6.1 | 62.42 | 57.61 | 53.32 | 49.38 | 52.13 | 60.87 | ? | ? |
| KENLM.n.6.2 | 62.42 | ? | ? | ? | 52.13 | ? | ? | ? |
| KENLM.y.3.0 | 61.82 | 59.30 | 53.64 | 49.69 | 51.50 | 62.77 | ? | ? |
| KENLM.y.3.1 | 61.82 | 59.30 | 53.64 | 49.69 | 51.50 | 62.77 | ? | ? |
| KENLM.y.3.2 | 61.82 | ? | ? | ? | 51.50 | 62.77 | ? | ? |
| KENLM.y.4.0 | 62.46 | 59.26 | 53.63 | 49.72 | 51.56 | 63.04 | ? | ? |
| KENLM.y.4.1 | 62.46 | 59.26 | 53.63 | 49.72 | 51.56 | 63.04 | ? | ? |
| KENLM.y.4.2 | 62.46 | ? | ? | ? | 51.56 | 63.04 | ? | ? |
| KENLM.y.5.0 | 62.51 | 58.95 | 53.52 | 49.76 | 51.45 | 62.50 | ? | ? |
| KENLM.y.5.1 | 62.51 | 58.95 | 53.52 | 49.76 | 51.45 | 62.50 | ? | ? |
| KENLM.y.5.2 | 62.51 | ? | ? | ? | 51.45 | 62.50 | ? | ? |
| KENLM.y.6.0 | 62.42 | 59.03 | 53.60 | 49.77 | 51.45 | 62.77 | ? | ? |
| KENLM.y.6.1 | 62.42 | 59.03 | 53.60 | 49.77 | 51.45 | 62.77 | ? | ? |
| KENLM.y.6.2 | 62.42 | ? | ? | ? | 51.45 | ? | ? | ? |
| LSTM.n+.0 | 63.16 | 51.64 | 50.01 | 49.63 | 53.38 | 43.00 | ? | ? |
| LSTM.n+.1 | 62.94 | 51.83 | 50.00 | 49.73 | 49.12 | 45.00 | ? | ? |
| LSTM.n+.2 | 58.30 | ? | ? | ? | 49.00 | 45.50 | ? | ? |
| LSTM.n.0 | 59.89 | 58.98 | 52.85 | 51.56 | 52.55 | 45.17 | ? | ? |
| LSTM.n.1 | 60.21 | 57.49 | 52.13 | 52.14 | 51.95 | 45.50 | ? | ? |
| LSTM.n.2 | 60.11 | ? | ? | ? | 50.74 | 45.50 | ? | ? |
| LSTM.y+.0 | 62.75 | 51.68 | 50.27 | 49.79 | 53.62 | 45.17 | ? | ? |
| LSTM.y+.1 | 50.48 | 56.70 | 50.03 | 49.62 | 49.12 | 45.00 | ? | ? |
| LSTM.y+.2 | 62.57 | ? | ? | ? | 49.07 | ? | ? | ? |
| LSTM.y.0 | 56.43 | 58.26 | 51.00 | 53.49 | 51.33 | 43.00 | ? | ? |
| LSTM.y.1 | 59.95 | 58.36 | 49.76 | 52.48 | 50.07 | 45.50 | ? | ? |
| LSTM.y.2 | 60.67 | ? | ? | ? | 51.43 | ? | ? | ? |
| LSTMAttention.n+.0 | 63.10 | 59.62 | __**56.48**__ | 53.24 | 53.16 | 55.33 | ? | ? |
| LSTMAttention.n+.1 | 62.94 | 59.00 | 55.70 | 52.75 | 54.17 | 55.33 | ? | ? |
| LSTMAttention.n+.2 | 62.94 | ? | ? | ? | __**54.91**__ | ? | ? | ? |
| LSTMAttention.n.0 | 61.68 | 58.09 | 52.97 | 54.83 | 51.41 | 55.33 | ? | ? |
| LSTMAttention.n.1 | 60.71 | 58.70 | 51.96 | 53.25 | 51.31 | 45.50 | ? | ? |
| LSTMAttention.n.2 | 60.75 | ? | ? | ? | 51.12 | 54.33 | ? | ? |
| LSTMAttention.y+.0 | 63.43 | 57.77 | 55.87 | 53.65 | 53.50 | 58.00 | ? | ? |
| LSTMAttention.y+.1 | 63.56 | 58.55 | 55.13 | 53.33 | 54.22 | 50.00 | ? | ? |
| LSTMAttention.y+.2 | 62.87 | ? | ? | ? | 53.74 | ? | ? | ? |
| LSTMAttention.y.0 | 60.21 | 58.38 | 52.84 | 53.90 | 51.17 | 55.33 | ? | ? |
| LSTMAttention.y.1 | 61.59 | 58.85 | 53.17 | 55.46 | 51.24 | 57.50 | ? | ? |
| LSTMAttention.y.2 | 59.68 | ? | ? | 55.53 | 49.21 | 58.50 | ? | ? |
| RCNN.n+.0 | 62.98 | 58.83 | 54.88 | 54.07 | 52.83 | 60.67 | ? | ? |
| RCNN.n+.1 | 63.41 | 59.32 | 54.86 | 54.12 | 53.79 | 60.17 | ? | ? |
| RCNN.n+.2 | 62.71 | ? | ? | 54.01 | 52.34 | 61.67 | ? | ? |
| RCNN.n.0 | 61.89 | 59.43 | 53.72 | 54.10 | 53.19 | 58.00 | ? | ? |
| RCNN.n.1 | 61.19 | 59.32 | 52.74 | 54.35 | 52.76 | 55.83 | ? | ? |
| RCNN.n.2 | 61.75 | ? | ? | ? | 51.81 | 57.83 | ? | ? |
| RCNN.y+.0 | 61.63 | 59.04 | 55.30 | 54.63 | 53.64 | 58.83 | ? | ? |
| RCNN.y+.1 | 63.49 | 59.15 | 54.83 | 53.63 | 52.45 | 60.67 | ? | ? |
| RCNN.y+.2 | 62.97 | ? | ? | ? | 54.53 | 60.00 | ? | ? |
| RCNN.y.0 | 61.32 | 59.19 | 54.69 | 52.21 | 54.69 | 58.33 | ? | ? |
| RCNN.y.1 | 60.76 | 60.45 | 52.58 | 54.16 | 52.71 | 57.33 | ? | ? |
| RCNN.y.2 | 61.06 | ? | ? | ? | 52.24 | ? | ? | ? |
| RNN.n+.0 | 55.62 | 54.00 | 53.39 | 52.26 | 52.64 | 45.67 | ? | ? |
| RNN.n+.1 | 53.14 | 53.72 | 50.82 | 51.12 | 51.66 | 46.67 | ? | ? |
| RNN.n+.2 | 60.79 | ? | ? | ? | 50.62 | 47.00 | ? | ? |
| RNN.n.0 | 56.43 | 57.53 | 50.56 | 53.03 | 52.97 | 51.67 | ? | ? |
| RNN.n.1 | 57.92 | 56.81 | 53.23 | 54.19 | 52.74 | 48.67 | ? | ? |
| RNN.n.2 | 58.35 | ? | ? | ? | 52.21 | ? | ? | ? |
| RNN.y+.0 | 56.62 | 53.23 | 52.99 | 53.36 | 50.40 | 47.67 | ? | ? |
| RNN.y+.1 | 54.37 | 50.98 | 50.73 | 51.20 | 51.45 | 49.00 | ? | ? |
| RNN.y+.2 | 55.97 | ? | ? | ? | 53.16 | ? | ? | ? |
| RNN.y.0 | 60.24 | 58.13 | 49.56 | 54.56 | 52.31 | 46.67 | ? | ? |
| RNN.y.1 | 58.27 | 57.74 | 52.85 | 52.79 | 51.47 | 49.67 | ? | ? |
| RNN.y.2 | 58.46 | ? | ? | ? | 51.76 | ? | ? | ? |
| SKLearn-knn.n.0 | 52.35 | 54.17 | 50.07 | 50.60 | 52.18 | 53.80 | ? | ? |
| SKLearn-knn.n.1 | 52.35 | 54.17 | 50.07 | 50.60 | 52.18 | 53.80 | ? | ? |
| SKLearn-knn.n.2 | 52.35 | ? | ? | ? | 52.18 | 53.80 | ? | ? |
| SKLearn-knn.y.0 | 51.60 | 53.83 | 50.71 | 51.04 | 50.93 | 50.00 | ? | 50.36 |
| SKLearn-knn.y.1 | 51.60 | 53.83 | 50.71 | 51.04 | 50.93 | 50.00 | ? | ? |
| SKLearn-knn.y.2 | 51.60 | ? | ? | 51.04 | 50.93 | ? | ? | ? |
| SKLearn-log.n.0 | 62.70 | 58.98 | 53.36 | 53.14 | 52.89 | 61.96 | ? | ? |
| SKLearn-log.n.1 | 62.70 | 58.98 | 53.36 | 53.14 | 52.89 | 61.96 | ? | ? |
| SKLearn-log.n.2 | 62.70 | ? | ? | ? | 52.89 | ? | ? | ? |
| SKLearn-log.y.0 | 63.00 | 59.25 | 53.93 | 53.21 | 53.60 | 65.22 | ? | ? |
| SKLearn-log.y.1 | 63.00 | 59.25 | 53.93 | 53.21 | 53.60 | 65.22 | ? | ? |
| SKLearn-log.y.2 | 63.00 | ? | ? | ? | 53.60 | ? | ? | ? |
| SKLearn-nb.n.0 | 64.50 | 58.44 | 54.43 | 51.24 | 52.46 | 62.50 | ? | ? |
| SKLearn-nb.n.1 | 64.50 | 58.44 | 54.43 | 51.24 | 52.46 | 62.50 | ? | ? |
| SKLearn-nb.n.2 | 64.50 | ? | ? | ? | 52.46 | ? | ? | ? |
| SKLearn-nb.y.0 | 64.60 | 59.93 | 54.67 | 51.40 | 51.53 | 64.13 | ? | ? |
| SKLearn-nb.y.1 | 64.60 | 59.93 | 54.67 | 51.40 | 51.53 | 64.13 | ? | ? |
| SKLearn-nb.y.2 | 64.60 | ? | ? | ? | 51.53 | 64.13 | ? | ? |
| SKLearn-rf.n.0 | 57.15 | 55.80 | 50.97 | 51.70 | 50.60 | 52.72 | ? | ? |
| SKLearn-rf.n.1 | 56.60 | 56.54 | 51.82 | 52.29 | 50.27 | 55.98 | ? | ? |
| SKLearn-rf.n.2 | 58.25 | ? | ? | ? | 50.76 | ? | ? | ? |
| SKLearn-rf.y.0 | 57.80 | 54.58 | 51.83 | 52.78 | 50.11 | 64.67 | ? | ? |
| SKLearn-rf.y.1 | 57.75 | 56.20 | 51.63 | 52.46 | 50.11 | 59.78 | ? | ? |
| SKLearn-rf.y.2 | 58.50 | ? | ? | ? | 52.02 | 65.22 | ? | ? |
| SKLearn-svm.n.0 | 62.80 | 59.66 | 51.84 | 52.22 | 50.98 | 63.04 | __**79.20**__ | ? |
| SKLearn-svm.n.1 | 62.80 | 59.66 | 51.84 | 52.22 | 50.98 | 63.04 | ? | ? |
| SKLearn-svm.n.2 | 62.80 | ? | ? | ? | 50.98 | ? | ? | ? |
| SKLearn-svm.y.0 | 61.05 | 58.85 | 51.93 | 52.98 | 52.73 | 65.22 | ? | ? |
| SKLearn-svm.y.1 | 61.05 | 58.85 | 51.93 | 52.98 | 52.73 | 65.22 | ? | ? |
| SKLearn-svm.y.2 | 61.05 | ? | ? | ? | 52.73 | ? | ? | ? |
| SelfAttention.n+.0 | 62.17 | 58.81 | 55.86 | 54.16 | 53.74 | 62.17 | ? | ? |
| SelfAttention.n+.1 | 63.52 | 57.94 | 54.93 | 53.35 | 52.83 | 57.33 | ? | ? |
| SelfAttention.n+.2 | 63.32 | ? | ? | ? | 52.33 | 57.00 | ? | ? |
| SelfAttention.n.0 | 61.81 | 57.83 | 53.68 | 53.82 | 51.76 | 51.17 | ? | ? |
| SelfAttention.n.1 | 60.37 | 59.47 | 53.85 | 56.13 | 51.91 | 56.33 | ? | ? |
| SelfAttention.n.2 | 61.27 | ? | ? | ? | 51.57 | 51.17 | ? | ? |
| SelfAttention.y+.0 | 63.29 | 57.94 | 55.36 | 54.57 | 52.10 | 61.67 | ? | ? |
| SelfAttention.y+.1 | 62.68 | 57.85 | 54.99 | 53.70 | 52.50 | 60.17 | ? | ? |
| SelfAttention.y+.2 | 62.22 | ? | ? | 53.55 | 53.03 | ? | ? | ? |
| SelfAttention.y.0 | 61.03 | 57.38 | 53.75 | 56.16 | 50.33 | 50.17 | ? | ? |
| SelfAttention.y.1 | 60.19 | 59.26 | 53.53 | 55.78 | 53.21 | 56.50 | ? | ? |
| SelfAttention.y.2 | 61.14 | ? | ? | ? | 53.05 | ? | ? | ? |
| Spacy.n.0 | 66.65 | __**62.92**__ | 55.79 | 54.22 | 53.60 | __**72.28**__ | ? | ? |
| Spacy.n.1 | 66.85 | 62.78 | 54.98 | 54.67 | 54.09 | 70.65 | ? | ? |
| Spacy.n.2 | 66.15 | ? | ? | ? | 53.55 | ? | ? | ? |
| Spacy.y.0 | __**66.90**__ | __**62.92**__ | 55.54 | 54.52 | 53.77 | 70.11 | ? | ? |
| Spacy.y.1 | 65.45 | 62.51 | 55.89 | 54.08 | 53.82 | 69.57 | ? | ? |
| Spacy.y.2 | 65.75 | ? | ? | ? | 54.64 | ? | ? | ? |